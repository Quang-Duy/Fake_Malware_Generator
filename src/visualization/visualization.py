import logging

import coloredlogs
import matplotlib.pyplot as plt
import numpy as np

logger = logging.getLogger(__name__)
coloredlogs.install(level=logging.DEBUG, logger=logger)
logger.propagate = False


def plot_losses(results, epochs):
    logger.info('Plotting ...')
    f_d, ax_d = plt.subplots(figsize=(9, 6))
    f_g, ax_g = plt.subplots(figsize=(9, 6))
    x = [val for val in range(epochs)]
    d = np.array([losses[0] for _, losses in results.items()])
    g = np.array([losses[1] for _, losses in results.items()])
    ax_d.set_ylabel('Discriminator Loss')
    ax_d.set_xlabel('Epochs')
    ax_g.set_ylabel('Generator Loss')
    ax_g.set_xlabel('Epochs')
    ax_d.plot(x, d, 'r', label='Discriminator loss')
    ax_d.set_title('GAN Discriminator Loss')
    ax_g.plot(x, g, 'b', label='Generator loss')
    ax_g.set_title('GAN Generator Loss')
    return f_d, ax_d, f_g, ax_g
